# Windows钩子

## 1、简介
Windows钩子（Windows Hook）是一种在Windows操作系统中实现的机制，它允许应用程序截获并处理其他应用程序的消息、事件或者输入。通过使用钩子，应用程序可以监视和控制其他应用程序的行为，从而实现一些高级的功能，比如键盘记录、鼠标跟踪、窗口管理等。

Windows钩子可以分为两种类型：全局钩子和局部钩子。全局钩子可以截获系统级别的事件，比如键盘输入、鼠标事件、窗口消息等，而局部钩子只能截获当前进程的事件。

使用Windows钩子需要编写钩子函数，并将其注册到系统中。钩子函数会在特定的事件发生时被调用，从而允许应用程序对这些事件进行处理。需要注意的是，钩子函数的执行速度应该尽可能快，以免影响系统的性能和稳定性。

总的来说，Windows钩子是一种非常强大的机制，可以帮助应用程序实现一些高级的功能。但是，由于其具有一定的风险和安全隐患，因此在使用时需要格外小心，避免对系统造成不必要的影响。

## 2、hook
在 Windows 编程中，"hook" 是一种机制，允许拦截系统级或特定线程级的事件，如键盘输入、鼠标移动、系统消息等。通过使用 hook，程序可以在这些事件传递到目标窗口或对象之前，对它们进行监视或修改。

Hook 通常用于以下目的：
- 事件监控：程序可以监控特定的事件，如用户的按键或鼠标点击，而不需要在每个应用程序中单独实现监控代码。
- 行为修改：在事件处理程序中，可以修改事件，或者在事件到达目标之前阻止它，从而改变系统或应用程序的默认行为。
- 扩展功能：可以在不修改原有程序代码的情况下，为应用程序添加额外的功能。
- 调试和测试：开发者可以使用 hook 来跟踪系统的行为，帮助调试和测试软件。

在 Windows API 中，有多种类型的 hook，包括但不限于：
- 键盘钩子：监控键盘输入。
- 鼠标钩子：监控鼠标移动和点击。
- 消息钩子：监控和处理窗口消息。
- 调用钩子：监控函数调用，如 API 调用或其他函数入口点。

创建 hook 通常涉及到以下步骤：
- 定义一个 Hook 函数：这个函数将会在每次相关事件发生时被调用。
- 设置 Hook：使用 Windows API（如 SetWindowsHookEx）来注册你的 Hook 函数。
- 处理事件：在你的 Hook 函数中处理事件。
- 卸载 Hook：在不再需要时，使用 UnhookWindowsHookEx 来移除 Hook。

使用 hook 需要谨慎，因为它们可以影响系统的稳定性和性能。此外，恶意软件可能会利用 hook 来监控用户的行为或者进行数据窃取，因此在安全软件中，hook 也是一个需要特别关注的点。

demo见：D:\Github\Storage\windows\KeyboardHook
