# gc模块使用和垃圾回收机制

## 1、简介
gc模块即Python中垃圾回收模块，它提供可选的垃圾回收器的接口。同时提供对回收器找到但是无法释放的不可达对象的访问。由于 Python 使用了带有引用计数的回收器，如果你确定你的程序不会产生循环引用，你可以关闭回收器。可以通过调用 gc.disable() 关闭自动垃圾回收。

## 2、Python中垃圾回收
python的垃圾回收器把所有对象分类为三代，其依据是对象在多少次垃圾回收后幸存。新建对象会被放在最年轻代（第 0 代）。如果一个对象在一次垃圾回收后幸存，它会被移入下一个较老代。由于第 2 代是最老代，这一代的对象在一次垃圾回收后仍会保留原样。为了确定何时要运行，垃圾回收器会跟踪自上一次回收后对象分配和释放的数量。当分配数量减去释放数量的结果值大于 threshold0 时，垃圾回收就会开始。初始时只有第 0 代会被检查。如果自第 1 代被检查后第 0 代已被检查超过 threshold1 次，则第 1 也会被检查。对于第三代来说情况还会更复杂。

## 3、提供的功能包括
1、关闭收集器
2、调整收集频率
3、设置调试选项

## 4、主要方法
```
enable()             --启用自动垃圾回收。
disable()            --禁用自动垃圾回收。
isenabled()          --如果启用了自动收集，则返回true。
collect()            --立即执行完全收集。
get_count()          --返回当前集合计数。
get_stats()          --返回包含每代统计信息的词典列表。
set_debug()          --设置调试标志。
get_debug()          --获取调试标志。
set_threshold()      --设置收集阈值。
get_threshold()      --返回集合阈值的当前值。
get_objects()        --返回收集器跟踪的所有对象的列表。
is_tracked()         --如果跟踪给定对象，则返回true。
is_finalized()       --如果给定对象已定稿，则返回true。
get_referrers()      --返回引用对象的对象列表。
get_referents()      --返回对象引用的对象列表。
freeze()             --冻结所有跟踪对象，并在将来的收集中忽略它们。
unfreeze()           --解冻永久生成中的所有对象。
get_freeze_count()   --返回永久生成中的对象数。
```

## 5、最常用的方法：gc.collect() 
立即执行完全收集，释放出不使用的资源，归还内存。可以通过参数generation，单独对0,1,2代进行回收释放。

## 6、单独对特定代收集
```
import gc
gc.collect(generation=0)
gc.collect(generation=1)
gc.collect(generation=2)
```

## 7、案例
代码见：D:\Github\Storage\python\study\gc\gc_example.py

需要注意的是：执行收集本身也需要一点的内存代价，所以可能存在收集完成后内存反而增加的情况。

















