# pipe函数

https://www.cnblogs.com/fortunely/p/14648146.html

## 1、简介
pipe函数可用于创建一个管道，以实现进程间的通信。
```
NAME
       pipe, pipe2 - create pipe

SYNOPSIS
       #include <unistd.h>

       int pipe(int pipefd[2]);

       #define _GNU_SOURCE             /* See feature_test_macros(7) */
       #include <fcntl.h>              /* Obtain O_* constant definitions */
       #include <unistd.h>

       int pipe2(int pipefd[2], int flags);
```

通过pipe函数创建的这两个文件描述符 fd[0] 和 fd[1] 分别构成管道的两端，往 fd[1] 写入的数据可以从 fd[0] 读出。并且 fd[1] 一端只能进行写操作，fd[0] 一端只能进行读操作，不能反过来使用。要实现双向数据传输，可以使用两个管道。

## 2、什么是管道
管道是半双工的，数据只能向一个方向流动；需要双方通信时，需要建立起两个管道； 只能用于父子进程或者兄弟进程之间（具有亲缘关系的进程）； 单独构成一种独立的文件系统：管道对于管道两端的进程而言，就是一个文件，但它不是普通的文件，它不属于某种文件系统，而是自立门户，单独构成一种文件系统，并且只存在于内存中。数据的读出和写入：一个进程向管道中写的内容被管道另一端的进程读出。写入的内容每次都添加在管道缓冲区的末尾，并且每次都是从缓冲区的头部读出数据。

## 3、管道的创建
int pipe(int fd[2])
该函数创建的管道的两端处于一个中间进程，在实际应用中并没有太大意义，一般在pipe()创建管道后，再fork()一个子进程，然后通过管道实现父子进程之间的通信。

管道由pipe函数创建，见pipe(2) — Linux manual page
```
#include <unistd.h>
/* fd返回2个文件描述符：fd[0]为读而打开；fd[1]为写而打开。fd[1]的输出是fd[0]的输入 */
int pipe(int fd[2]);

/* 提供位元选项可设置。flags=0时，pipe2同pipe。
 * 常用选项：O_NONBLOCK，linux特有的。
 */
int pipe2(int fd[2], int flags);
```

通过fd[0]调用read()读取数据的一端，叫读端；通过fd[1]调用write()写数据的一端进程，叫写端。

通常的创建模型：
```
int pipefd[2];
ret = pipe(pipefd);
fork();
```

## 4、管道的读写规则
管道两端可分别用描述字fd[0]以及fd[1]来描述，需要注意的是，管道的两端是固定了任务的。即一端只能用于读，由描述字fd[0]表示，称其为管道读端；另一端则只能用于写，由描述字fd[1]来表示，称其为管道写端。

## 5、管道特点
管道通常指无名管道，是IPC最古老的形式。管道有何特点？

半双工通信，具有固定的读端、写端（单向传输数据）；
管道只能在具有公共祖先的2个进程间使用，通常是父子进程；

同一个进程使用管道没有意义，因为管道专门用于进程间通信。进程内的通信使用全局变量即可。要实现父子进程的通信，创建管道后，需要关闭一个读端，一个写端。比如一个从父进程到子进程的管道，父进程关闭fd[0]，子进程关闭fd[1]。

## 6、




